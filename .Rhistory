# If necessary
# install.packages(c('rdd','rddensity'))
# Load RDD of house elections from the R package rddtools,
# and originally from Lee (2008) https://www.sciencedirect.com/science/article/abs/pii/S0304407607001121
df <- read.csv("https://raw.githubusercontent.com/LOST-STATS/LOST-STATS.github.io/master/Model_Estimation/Data/Regression_Discontinuity_Design/house.csv")
## Run McCrary (2008) version of the test
library(rdd)
# Give it the running variable and the cutpoint
# it will automatically produce a plot and select the number of bins and the bandwidth
# The output will be hte p-value for the presence of a discontinuity
DCdensity(df$x, c = 0)
## Run the Cattaneo, Jansson, and Ma (2020) estimator
library(rddensity)
# Load RDD of house elections from the R package rddtools,
# and originally from Lee (2008) https://www.sciencedirect.com/science/article/abs/pii/S0304407607001121
df <- read.csv("https://raw.githubusercontent.com/LOST-STATS/LOST-STATS.github.io/master/Model_Estimation/Data/Regression_Discontinuity_Design/house.csv")
## Run McCrary (2008) version of the test
library(rdd)
# Give it the running variable and the cutpoint
# it will automatically produce a plot and select the number of bins and the bandwidth
# The output will be hte p-value for the presence of a discontinuity
DCdensity(df$x, c = 0)
## Run the Cattaneo, Jansson, and Ma (2020) estimator
library(rddensity)
# Give it the running variable and the cutoff
# It will pick the bandwidth, and has default polynomials, kernel, and bias correction
# It doesn't have bins to pick
denstest <- rddensity(df$x, c = 0)
summary(denstest)
View(df)
# Not plot the density discontinuity
# It needs the density test object we just made
rdplotdensity(denstest, df$x)
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(5, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
large_means <- replicate(1000, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(1, 0, 10)))  # n = 5
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(1, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(1000, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(1000, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(2, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(1000, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(1000, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(300, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(3000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(3000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(3000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(3000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(30000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(30000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(100, mean(runif(30000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(100, mean(runif(3, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(1000, mean(runif(30000, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Simple Central Limit Theorem Demonstration
# Show that sample means become normal, regardless of population distribution
# Step 1: Create a uniform population (clearly NOT normal)
population <- runif(10000, min = 0, max = 10)  # Flat distribution
hist(population, main = "Population: Uniform (Flat)", col = "lightblue")
# Step 2: Draw many sample means with SMALL sample size
small_means <- replicate(1000, mean(runif(5, 0, 10)))  # n = 5
hist(small_means, main = "Sample Means (n = 5)", col = "pink")
# Step 3: Draw many sample means with LARGE sample size
large_means <- replicate(1000, mean(runif(30, 0, 10)))  # n = 30
hist(large_means, main = "Sample Means (n = 30) - Now Normal!", col = "lightgreen")
# The magic: Compare the shapes
par(mfrow = c(1,3))  # Show all three plots side by side
hist(population, main = "Population\n(Uniform)", col = "lightblue")
hist(small_means, main = "Sample Means\n(n = 5)", col = "pink")
hist(large_means, main = "Sample Means\n(n = 30)", col = "lightgreen")
# Student questions to ask:
cat("Ask your students:\n")
cat("1. What shape is the population? (Flat/Uniform)\n")
cat("2. What happens to sample means as n increases? (Gets more normal!)\n")
cat("3. Why does this matter? (We can use normal theory for ANY population!)\n")
# Gradual Central Limit Theorem Demonstration
# Show the GRADUAL transition from non-normal to normal
# Step 1: Create a VERY non-normal population
population <- rexp(10000, rate = 0.3)  # Highly skewed exponential
hist(population, main = "Population: Exponential (Very Skewed)", col = "lightblue", breaks = 30)
# Step 2: Show gradual transition with different sample sizes
sample_sizes <- c(2, 5, 10, 20, 50)  # More gradual progression
# Set up plots side by side
par(mfrow = c(2, 3))
# Show population first
hist(population, main = "Population\n(Exponential)", col = "lightblue", breaks = 30)
# Draw sample means for each sample size
for (n in sample_sizes) {
sample_means <- replicate(1000, mean(rexp(n, rate = 0.3)))
hist(sample_means,
main = paste("Sample Means\n(n =", n, ")"),
col = rainbow(length(sample_sizes))[which(sample_sizes == n)],
breaks = 20,
xlim = c(0, 8))  # Keep same scale for comparison
}
# Reset plot layout
par(mfrow = c(1, 1))
# Student discussion prompts
cat("Ask students to observe the GRADUAL change:\n")
cat("n = 2:  Still very skewed like population\n")
cat("n = 5:  Getting less skewed\n")
cat("n = 10: Starting to look more symmetric\n")
cat("n = 20: Much more bell-shaped\n")
cat("n = 50: Very close to normal!\n")
# Alternative: Try with uniform but make it more obvious
cat("\n--- Alternative with Bimodal Population ---\n")
par(mfrow = c(2, 3))
# Create bimodal population (two humps - clearly not normal)
bimodal_pop <- c(rnorm(5000, mean = 2, sd = 0.5),
rnorm(5000, mean = 8, sd = 0.5))
hist(bimodal_pop, main = "Population\n(Bimodal - Two Humps)", col = "lightcoral", breaks = 30)
# Show gradual transition
for (n in sample_sizes) {
sample_means <- replicate(1000, mean(sample(bimodal_pop, n)))
hist(sample_means,
main = paste("Sample Means\n(n =", n, ")"),
col = rainbow(length(sample_sizes))[which(sample_sizes == n)],
breaks = 20,
xlim = c(3, 7))
}
# CLT Demo with Built-in Skewed Distributions
# Using R's built-in functions for easy replication
# Option 1: Exponential distribution (highly right-skewed)
par(mfrow = c(2, 3))
# Population: Exponential
pop_exp <- rexp(10000, rate = 1)  # Built-in exponential
hist(pop_exp, main = "Population\n(Exponential - Very Skewed)",
col = "lightblue", breaks = 30, xlim = c(0, 8))
# Gradual sample sizes
sample_sizes <- c(2, 5, 15, 30, 50)
for (n in sample_sizes) {
# Use rexp() directly - no need to create population first
sample_means <- replicate(1000, mean(rexp(n, rate = 1)))
hist(sample_means,
main = paste("Sample Means\n(n =", n, ")"),
col = heat.colors(length(sample_sizes))[which(sample_sizes == n)],
breaks = 20,
xlim = c(0, 3))
}
# Option 2: Chi-square distribution (another built-in skewed option)
par(mfrow = c(2, 3))
# Population: Chi-square with 2 degrees of freedom (very skewed)
pop_chisq <- rchisq(10000, df = 2)
hist(pop_chisq, main = "Population\n(Chi-square, df=2)",
col = "lightcoral", breaks = 30, xlim = c(0, 15))
for (n in sample_sizes) {
# Use rchisq() directly
sample_means <- replicate(1000, mean(rchisq(n, df = 2)))
hist(sample_means,
main = paste("Sample Means\n(n =", n, ")"),
col = terrain.colors(length(sample_sizes))[which(sample_sizes == n)],
breaks = 20,
xlim = c(0, 6))
}
# Option 3: Log-normal distribution (extremely skewed)
par(mfrow = c(2, 3))
pop_lnorm <- rlnorm(10000, meanlog = 0, sdlog = 1)
hist(pop_lnorm, main = "Population\n(Log-normal - Extreme Skew)",
col = "lightyellow", breaks = 50, xlim = c(0, 15))
for (n in sample_sizes) {
sample_means <- replicate(1000, mean(rlnorm(n, meanlog = 0, sdlog = 1)))
hist(sample_means,
main = paste("Sample Means\n(n =", n, ")"),
col = cm.colors(length(sample_sizes))[which(sample_sizes == n)],
breaks = 20,
xlim = c(0, 4))
}
# Reset layout
par(mfrow = c(1, 1))
cat("Built-in R distributions to try:\n")
cat("rexp(n, rate = 1)     # Exponential - right skewed\n")
cat("rchisq(n, df = 2)     # Chi-square - right skewed\n")
cat("rlnorm(n, 0, 1)       # Log-normal - extremely skewed\n")
cat("rgamma(n, 1, 1)       # Gamma - right skewed\n")
cat("rf(n, 2, 5)           # F-distribution - right skewed\n")
cat("\nFor classroom: Just change the distribution function!\n")
cat("Example: replicate(1000, mean(rchisq(30, df=2)))\n")
pop_exp
install.packages("tinytex")
install.packages("tinytex")
tinytex::install_tinytex()
Y
tinytex::install_tinytex()
YES
install.packages("tinytex")
install.packages("tinytex")
tinytex::install_tinytex()
N
tinytex::install_tinytex()
'Y'
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# Exercise 3:
# Calculate distances between Wisconsin and all other states
# Hint: Use dist() function or manual calculation
```
---
title: "T-Test Guide Using US Crime Statistics"
---
title: "T-Test Guide Using US Crime Statistics"
unlink("~/Desktop/eco230-syllabus/hyp-testing-recap_cache", recursive = TRUE)
---
title: "T-Test Guide Using US Crime Statistics"
---
title: "T-Test Guide Using US Crime Statistics"
---
title: "T-Test Guide Using US Crime Statistics"
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.height = 4, fig.width = 6)
# Load the US crime data
data("USArrests")
# Display first few rows
head(USArrests)
# Show data structure
str(USArrests)
# Summary statistics for all variables
summary(USArrests)
# Create decision matrix table
matrix_data <- matrix(c("Correct Decision", "Type II Error (beta)",
"Type I Error (alpha)", "Correct Decision"),
nrow = 2, ncol = 2,
dimnames = list(c("H0 is Actually TRUE", "H0 is Actually FALSE"),
c("Fail to Reject H0", "Reject H0")))
print(matrix_data)
View(USArrests)
